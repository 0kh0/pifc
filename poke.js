ids= 
[["Slowking",199]
,["Azurill",252]
,["Wynaut",253]
,["Ambipom",254]
,["Mismagius",255]
,["Honchrow",256]
,["Bonsly",257]
,["Mime-jr",258]
,["Happiny",259]
,["Munchlax",260]
,["Mantyke",261]
,["Weavile",262]
,["Magnezone",263]
,["Lickilicky",264]
,["Rhyperior",265]
,["Tangrowth",266]
,["Electivire",267]
,["Magmortar",268]
,["Togekiss",269]
,["Yanmega",270]
,["Leafeon",271]
,["Glaceon",272]
,["Gliscor",273]
,["Mamoswine",274]
,["Porygon-z",275]
,["Treecko",276]
,["Grovyle",277]
,["Sceptile",278]
,["Torchic",279]
,["Combusken",280]
,["Blaziken",281]
,["Mudkip",282]
,["Marshtomp",283]
,["Swampert",284]
,["Ralts",285]
,["Kirlia",286]
,["Gardevoir",287]
,["Gallade",288]
,["Shedinja",289]
,["Kecleon",290]
,["Beldum",291]
,["Metang",292]
,["Metagross",293]
,["Bidoof",294]
,["Spiritomb",295]
,["Lucario",296]
,["Gible",297]
,["Gabite",298]
,["Garchomp",299]
,["Mawile",300]
,["Lileep",301]
,["Cradily",302]
,["Anorith",303]
,["Armaldo",304]
,["Cranidos",305]
,["Rampardos",306]
,["Shieldon",307]
,["Bastiodon",308]
,["Slaking",309]
,["Absol",310]
,["Duskull",311]
,["Dusclops",312]
,["Dusknoir",313]
,["Wailord",314]
,["Arceus",315]
,["Turtwig",316]
,["Grotle",317]
,["Torterra",318]
,["Chimchar",319]
,["Monferno",320]
,["Infernape",321]
,["Piplup",322]
,["Prinplup",323]
,["Empoleon",324]
,["Nosepass",325]
,["Probopass",326]
,["Honedge",327]
,["Doublade",328]
,["Aegislash-shield",329]
,["Pawniard",330]
,["Bisharp",331]
,["Luxray",332]
,["Aggron",333]
,["Flygon",334]
,["Milotic",335]
,["Salamence",336]
,["Klinklang",337]
,["Zoroark",338]
,["Sylveon",339]
,["Kyogre",340]
,["Groudon",341]
,["Rayquaza",342]
,["Dialga",343]
,["Palkia",344]
,["Giratina-altered",345]
,["Regigigas",346]
,["Darkrai",347]
,["Genesect",348]
,["Reshiram",349]
,["Zekrom",350]
,["Kyurem",351]
,["Roserade",352]
,["Drifblim",353]
,["Lopunny",354]
,["Breloom",355]
,["Ninjask",356]
,["Banette",357]
,["Rotom",358]
,["Reuniclus",359]
,["Whimsicott",360]
,["Krookodile",361]
,["Cofagrigus",362]
,["Galvantula",363]
,["Ferrothorn",364]
,["Litwick",365]
,["Lampent",366]
,["Chandelure",367]
,["Haxorus",368]
,["Golurk",369]
,["Pyukumuku",370]
,["Klefki",371]
,["Talonflame",372]
,["Mimikyu-disguised",373]
,["Volcarona",374]
,["Deino",375]
,["Zweilous",376]
,["Hydreigon",377]
,["Latias",378]
,["Latios",379]
,["Deoxys-normal",380]
,["Jirachi",381]
,["Nincada",382]
,["Bibarel",383]
,["Riolu",384]
,["Slakoth",385]
,["Vigoroth",386]
,["Wailmer",387]
,["Shinx",388]
,["Luxio",389]
,["Aron",390]
,["Lairon",391]
,["Trapinch",392]
,["Vibrava",393]
,["Feebas",394]
,["Bagon",395]
,["Shellgon",396]
,["Klink",397]
,["Klank",398]
,["Zorua",399]
,["Budew",400]
,["Roselia",401]
,["Drifloon",402]
,["Buneary",403]
,["Shroomish",404]
,["Shuppet",405]
,["Solosis",406]
,["Duosion",407]
,["Cottonee",408]
,["Sandile",409]
,["Krokorok",410]
,["Yamask",411]
,["Joltik",412]
,["Ferroseed",413]
,["Axew",414]
,["Fraxure",415]
,["Golett",416]
,["Fletchling",417]
,["Fletchinder",418]
,["Larvesta",419]
,["Stunfisk",420]]

nameException=[
"mr.mime",
"mime.jr",
"deoxys",
"giratina",
"mimikyu",
"aegislash",
]

nameFix=[
"mr-mime",
"mime-jr",
"deoxys-normal",
"giratina-altered",
"mimikyu-disguised",
"aegislash-shield",
]

typeSwap=
[["steel","electric","Magnemite"]
,["steel","electric","Magneton"]
,["ice","water","Dewgong"]
,["water","rock","Omanyte"]
,["water","rock","Omastar"]
,["steel","bug","Scizor"]
,["steel","electric","Magnezone"]]

typeUni=
[["grass","Bulbasaur"]
,["grass","Ivysaur"]
,["grass","Venusaur"]
,["fire","Charizard"]
,["rock","Geodude"]
,["rock","Graveler"]
,["rock","Golem"]
,["ghost","Gastly"]
,["ghost","Haunter"]
,["ghost","Gengar"]
,["rock","Onix"]
,["bug","Scyther"]
,["water","Gyarados"]
,["ice","Articuno"]
,["electric","Zapdos"]
,["fire","Moltres"]
,["dragon","Dragonite"]
,["steel","Steelix"]]

var types = new Array(
    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.5, 0, 1, 1, 0.5, 1, 1],// Normal
    [1, 0.5, 0.5, 1, 2, 2, 1, 1, 1, 1, 1, 2, 0.5, 1, 0.5, 1, 2, 1, 1],// Fire
    [1, 2, 0.5, 1, 0.5, 1, 1, 1, 2, 1, 1, 1, 2, 1, 0.5, 1, 1, 1, 1],// Water
    [1, 1, 2, 0.5, 0.5, 1, 1, 1, 0, 2, 1, 1, 1, 1, 0.5, 1, 1, 1, 1],// Electric
    [1, 0.5, 2, 1, 0.5, 1, 1, 0.5, 2, 0.5, 1, 0.5, 2, 1, 0.5, 1, 0.5, 1, 1],// Grass
    [1, 0.5, 0.5, 1, 2, 0.5, 1, 1, 2, 2, 1, 1, 1, 1, 2, 1, 0.5, 1, 1],// Ice
    [2, 1, 1, 1, 1, 2, 1, 0.5, 1, 0.5, 0.5, 0.5, 2, 0, 1, 2, 2, 0.5, 1],// Fighting
    [1, 1, 1, 1, 2, 1, 1, 0.5, 0.5, 1, 1, 1, 0.5, 0.5, 1, 1, 0, 2, 1],// Poison
    [1, 2, 1, 2, 0.5, 1, 1, 2, 1, 0, 1, 0.5, 2, 1, 1, 1, 2, 1, 1],// Ground
    [1, 1, 1, 0.5, 2, 1, 2, 1, 1, 1, 1, 2, 0.5, 1, 1, 1, 0.5, 1, 1],// Flying
    [1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 0.5, 1, 1, 1, 1, 0, 0.5, 1, 1],// Psychic
    [1, 0.5, 1, 1, 2, 1, 0.5, 0.5, 1, 0.5, 2, 1, 1, 0.5, 1, 2, 0.5, 0.5, 1],// Bug
    [1, 2, 1, 1, 1, 2, 0.5, 1, 0.5, 2, 1, 2, 1, 1, 1, 1, 0.5, 1, 1],// Rock
    [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 0.5, 1, 1, 1],// Ghost
    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 0.5, 0, 1],// Dragon
    [1, 1, 1, 1, 1, 1, 0.5, 1, 1, 1, 2, 1, 1, 2, 1, 0.5, 1, 0.5, 1],// Dark
    [1, 0.5, 0.5, 0.5, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 0.5, 2, 1],// Steel
    [1, 0.5, 1, 1, 1, 1, 2, 0.5, 1, 1, 1, 1, 1, 1, 2, 2, 0.5, 1, 1],// Fairy
    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]);// None
    
var type_name = new Array("Normal", "Fire", "Water", "Electric", "Grass", "Ice", "Fighting", "Poison", "Ground", "Flying", "Psychic", "Bug", "Rock", "Ghost", "Dragon", "Dark", "Steel", "Fairy");
    

var ty1 = $("#def_type1").val();
var ty2 = $("#def_type2").val();
var result = new Array();
var output;
var i;

for (i=0; i<=18; i++) {
result[i] = (types[i][ty1] * types[i][ty2]);
if((types[i][ty1] * types[i][ty2]) < 2){result[i] = 0};
if((types[i][ty1] * types[i][ty2]) >= 2){result[i] = result[i] * 0.75};
}


//Press ENTER on text area 1
var pkmn1 = document.getElementById('fname1');
pkmn1.addEventListener("keydown",function(event) {
    if (event.keyCode===13) {
        event.preventDefault();
        document.getElementById("button").click();
    }
});

//Press ENTER on text area 2
var pkmn2 = document.getElementById('fname2');
pkmn2.addEventListener("keydown",function(event) {
    if (event.keyCode===13) {
        event.preventDefault();
        document.getElementById("button").click();
    }
});

//Fusion calculation function
function selectPoke() {

    //Pokemon from both text area
    var mon1 = (document.getElementById("fname1")).value.toLowerCase();
    var mon2 = (document.getElementById("fname2")).value.toLowerCase();
    if ((mon1 == "" || mon1.length == 0 || mon1 == null) || (mon2 == "" || mon2.length == 0 || mon2 == null)) {
        alert("Please fill the two text inputs!");
    } else {
        //Special mon selector: Giratina, Deoxys
        if (nameException.includes(mon1)) {
            mon1=nameFix[nameException.indexOf(mon1)];
        }
        if (nameException.includes(mon2)) {
            mon2=nameFix[nameException.indexOf(mon2)];
         }

        //First request
        var txhr = new XMLHttpRequest();  
        var poke1 = 'https://pokeapi.co/api/v2/pokemon/'+mon1
        txhr.open('GET', poke1, true);
        txhr.send();
        txhr.onload = function() {
        var jsonBody = txhr.responseText;
        var jsonString = JSON.parse(jsonBody);

        //ID selector for sprite showcase of the 1st mon/ Validator for 1st mon
        var num1 = jsonString.id;
        var id1 = num1;
        var idCheck1 = false;
        for (i=0;i<ids.length;i++){
            if (ids[i][0]==mon1.charAt(0).toUpperCase() + mon1.slice(1)) {
                idCheck1 = true;
                num1=ids[i][1];
            }
        }
        if (idCheck1==false && id1>=252) {
            alert("The first pokemon isn't in the fangame!")
        } else {
            //Type selector for fusion type knowledge of the 1st mon
            var type1 = jsonString.types;
            console.log(type1[0].type.name);
            var poke1 = 'https://pokeapi.co/api/v2/pokemon/'+type1[0].type.name;
            console.log(poke1);
            var mon1types = [];
            var compt=0

            //Exception mon selected for swapped types
            for (i=0;i<typeSwap.length;i++) {
                if (typeSwap[i][2]==mon1.charAt(0).toUpperCase() + mon1.slice(1)) {
                    mon1types.push(typeSwap[i][0]);
                    mon1types.push(typeSwap[i][1]);
                    var compt=1;
                }
            }

            //Exception mon selected for one type
            for (i=0;i<typeUni.length;i++) {
                if (typeUni[i][1]==mon1.charAt(0).toUpperCase() + mon1.slice(1)) {
                    mon1types.push(typeUni[i][0]);
                    var compt=2;
                }
            }

            //Type of 1st mon
            if (compt==0) {
                mon1types.push(type1[0].type.name);
                if (type1.length==2 && compt!=2) {
                    if (type1[0].type.name=="normal" && type1[1].type.name=="flying") {
                        mon1types[0]="flying";
                    } else {
                        mon1types.push(type1[1].type.name);
                    }
                }
            }
            
            //Stats of 1st mon
            var stats1 = jsonString.stats;
            var mon1stats = [];
            for (i=0; i<stats1.length;i++) {
                mon1stats.push(stats1[i].base_stat)
            }

            //Ability of 1st mon
            var ab1 = jsonString.abilities;
            var mon1abilities = [];
                for (i=0; i<ab1.length;i++) {
                    mon1abilities.push([ab1[i].ability,ab1[i].is_hidden]);
                }

            //2nd request
            var pxhr = new XMLHttpRequest();
            var poke2 = 'https://pokeapi.co/api/v2/pokemon/'+mon2
            pxhr.open('GET', poke2, true);
            pxhr.send();
            pxhr.onload = function() {
                
                //Name of fusion
                if (!nameFix.includes(mon1) && !nameFix.includes(mon2)) {
                    var fmon1 = mon1.charAt(0).toUpperCase() + mon1.slice(1);
                    var fmon2 = mon2.charAt(0).toUpperCase() + mon2.slice(1);
                } else if (nameFix.includes(mon1) && !nameFix.includes(mon2)) {
                    var fmon1 = nameException[nameFix.indexOf(mon1)].charAt(0).toUpperCase() + nameException[nameFix.indexOf(mon1)].slice(1);
                    var fmon2 = mon2.charAt(0).toUpperCase() + mon2.slice(1);
                } else if (!nameFix.includes(mon1) && nameFix.includes(mon2)) {
                    var fmon1 = mon1.charAt(0).toUpperCase() + mon1.slice(1);
                    var fmon2 = nameException[nameFix.indexOf(mon2)].charAt(0).toUpperCase() + nameException[nameFix.indexOf(mon2)].slice(1);
                } else if (nameFix.includes(mon1) && nameFix.includes(mon2)) {
                    var fmon1 = nameException[nameFix.indexOf(mon1)].charAt(0).toUpperCase() + nameException[nameFix.indexOf(mon1)].slice(1);
                    var fmon2 = nameException[nameFix.indexOf(mon2)].charAt(0).toUpperCase() + nameException[nameFix.indexOf(mon2)].slice(1);
                }

                var jsonBody = pxhr.responseText;
                var jsonString = JSON.parse(jsonBody);

                //ID selector for sprite showcase of the 2st mon
                var num2 = jsonString.id;
                var id2 = num2;
                var idCheck2 = false;
                for (i=0;i<ids.length;i++){
                    if (ids[i][0]==mon2.charAt(0).toUpperCase() + mon2.slice(1)) {
                        idCheck2 = true;
                        num2=ids[i][1];
                    }
                }
                if (idCheck2==false && id2>=252) {
                    alert("The second pokemon isn't in the fangame!")
                } else {

                    //Name of fusions
                    document.getElementById("FP1").innerHTML=fmon1+"/"+fmon2;
                    document.getElementById("FP2").innerHTML=fmon2+"/"+fmon1;

                    //Name of pictures
                    var pic1 = num1+"."+num2+".png";
                    var pic2 = num2+"."+num1+".png";

                    //Type selector for fusion type knowledge of the 2nd mon
                    var type2 = jsonString.types;
                    var mon2types = [];
                    var compt=0

                    //Exception mon selected for swapped types
                    for (i=0;i<typeSwap.length;i++) {
                        if (typeSwap[i][2]==mon2.charAt(0).toUpperCase() + mon2.slice(1)) {
                            mon2types.push(typeSwap[i][0]);
                            mon2types.push(typeSwap[i][1]);
                            var compt=1;
                        }
                    }
            
                    //Exception mon selected for one type
                    for (i=0;i<typeUni.length;i++) {
                        if (typeUni[i][1]==mon2.charAt(0).toUpperCase() + mon2.slice(1)) {
                            mon2types.push(typeUni[i][0]);
                            var compt=2;
                        }
                    }
            
                    //Type of 2nd mon
                    if (compt==0) {
                        mon2types.push(type2[0].type.name);
                        if (type2.length==2 && compt!=2) {
                            if (type2[0].type.name=="normal" && type2[1].type.name=="flying") {
                                mon2types[0]="flying";
                            } else {
                                mon2types.push(type2[1].type.name);
                            }
                        }
                    }

                    //Stats of 2nd mon
                    var stats2 = jsonString.stats;
                    var mon2stats = [];
                    for (i=0; i<stats2.length;i++) {
                        mon2stats.push(stats2[i].base_stat)
                    }

                    //Abilities of 2nd mon
                    var ab2 = jsonString.abilities;
                    var mon2abilities = [];
                    for (i=0; i<ab2.length;i++) {
                        mon2abilities.push([ab2[i].ability,ab2[i].is_hidden]);
                    }

                    //Stats calculation
                    var hp1 = (mon2stats[0]/3)+2*(mon1stats[0]/3);
                    var atk1 = 2*(mon2stats[1]/3)+(mon1stats[1]/3);
                    var def1 = 2*(mon2stats[2]/3)+(mon1stats[2]/3);
                    var spatk1 = (mon2stats[3]/3)+2*(mon1stats[3]/3);
                    var spdef1 = (mon2stats[4]/3)+2*(mon1stats[4]/3);
                    var spe1 = 2*(mon2stats[5]/3)+(mon1stats[5]/3);
                    var bs1 = Math.floor(hp1)+Math.floor(atk1)+Math.floor(def1)+Math.floor(spatk1)+Math.floor(spdef1)+Math.floor(spe1);

                    var hp2 = (mon1stats[0]/3)+2*(mon2stats[0]/3);
                    var atk2 = 2*(mon1stats[1]/3)+(mon2stats[1]/3);
                    var def2= 2*(mon1stats[2]/3)+(mon2stats[2]/3);
                    var spatk2 = (mon1stats[3]/3)+2*(mon2stats[3]/3);
                    var spdef2 = (mon1stats[4]/3)+2*(mon2stats[4]/3);
                    var spe2 = 2*(mon1stats[5]/3)+(mon2stats[5]/3);
                    var bs2 = Math.floor(hp2)+Math.floor(atk2)+Math.floor(def2)+Math.floor(spatk2)+Math.floor(spdef2)+Math.floor(spe2);

                    var L0=["hp1","atk1","def1","spatk1","spdef1","spe1","bs1"];
                    var L1=["hp2","atk2","def2","spatk2","spdef2","spe2","bs2"];
                    var L2=[Math.floor(hp1),Math.floor(atk1),Math.floor(def1),Math.floor(spatk1),Math.floor(spdef1),Math.floor(spe1),Math.floor(bs1)];
                    var L3=[Math.floor(hp2),Math.floor(atk2),Math.floor(def2),Math.floor(spatk2),Math.floor(spdef2),Math.floor(spe2),Math.floor(bs2)];

                    //Color of stats
                    for (i=0;i<L1.length;i++) {
                        if (L2[i]<L3[i]) {
                            document.getElementById(L0[i]).style.color="red";
                            document.getElementById(L1[i]).style.color="green";
                        } else if (L2[i]>L3[i]) {
                            document.getElementById(L1[i]).style.color="red";
                            document.getElementById(L0[i]).style.color="green";
                        } else {
                            document.getElementById(L1[i]).style.color="orange";
                            document.getElementById(L0[i]).style.color="orange";
                        }
                        document.getElementById(L0[i]).innerHTML=L0[i].slice(-1)+": "+L2[i];
                        document.getElementById(L1[i]).innerHTML=L1[i].slice(-1)+": "+L3[i];
                    }

                    //Writting stat in HTML
                    document.getElementById("hp1").innerHTML="HP: "+Math.floor(hp1);
                    document.getElementById("atk1").innerHTML="ATK: "+Math.floor(atk1);
                    document.getElementById("def1").innerHTML="DEF: "+Math.floor(def1);
                    document.getElementById("spatk1").innerHTML="SPE.ATK: "+Math.floor(spatk1);
                    document.getElementById("spdef1").innerHTML="SPE.DEF: "+Math.floor(spdef1);
                    document.getElementById("spe1").innerHTML="SPEED: "+Math.floor(spe1);
                    document.getElementById("bs1").innerHTML="TOTAL: "+Math.floor(bs1);

                    document.getElementById("hp2").innerHTML="HP: "+Math.floor(hp2);
                    document.getElementById("atk2").innerHTML="ATK: "+Math.floor(atk2);
                    document.getElementById("def2").innerHTML="DEF: "+Math.floor(def2);
                    document.getElementById("spatk2").innerHTML="SPE.ATK: "+Math.floor(spatk2);
                    document.getElementById("spdef2").innerHTML="SPE.DEF: "+Math.floor(spdef2);
                    document.getElementById("spe2").innerHTML="SPEED: "+Math.floor(spe2);
                    document.getElementById("bs2").innerHTML="TOTAL: "+Math.floor(bs2);

                    //Abilities of fused mons
                    var abres1 = fusAb(mon1abilities,mon2abilities);
                    var abres2 = fusAb(mon2abilities,mon1abilities);
                    
                    
                    //Type of fused mons
                    var fmonres1 = fusType(mon1types,mon2types);
                    var fmonres2 = fusType(mon2types,mon1types);

                    document.getElementById("p1").src="./Types/"+fmonres1[0]+".png";
                    if (fmonres1.length!=1 && (fmonres1.length==2 && fmonres1[0]!=fmonres1[1])) {
                        document.getElementById("p2").style.display="inline-block";
                        document.getElementById("p2").src="./Types/"+fmonres1[1]+".png";
                    } else {
                        document.getElementById("p2").style.display="none";
                    }

                    document.getElementById("p3").src="./Types/"+fmonres2[0]+".png";

                    if (fmonres2.length!=1 && (fmonres2.length==2 && fmonres2[0]!=fmonres2[1])) {
                        document.getElementById("p4").style.display="inline-block";
                        document.getElementById("p4").src="./Types/"+fmonres2[1]+".png";
                    } else {
                        document.getElementById("p4").style.display="none";
                    }

                    //Picture of fusion (if in folder)
                    document.getElementById("pic1").src="./CustomBattlers/"+pic1;
                    document.getElementById("pic2").src="./CustomBattlers/"+pic2;

                    var listAb1 = "ABILITY: ";
                    for (i=0;i<abres1.length;i++) {
                        listAb1 = listAb1+abres1[i].charAt(0).toUpperCase() + abres1[i].slice(1)+" / ";
                    }
                    listAb1=listAb1.slice(0,listAb1.length-1);
                    listAb1=listAb1.split("-").join(" ")
                    listAb1=listAb1.split(" ")
                    for (i=0, x=listAb1.length; i<x; i++) {
                        listAb1[i] = listAb1[i][0].toUpperCase() + listAb1[i].substr(1);
                    }
                    listAb1=listAb1.join(" ").slice(0,-2);

                    document.getElementById("ab1").innerHTML=" ";
                    document.getElementById("ab1").innerHTML=listAb1;

                    var listAb2 = "ABILITY: ";
                    for (i=0;i<abres2.length;i++) {
                        listAb2 = listAb2+abres2[i].charAt(0).toUpperCase() + abres2[i].slice(1)+" / ";
                    }
                    listAb2=listAb2.slice(0,listAb2.length-1);
                    listAb2=listAb2.split("-").join(" ")
                    listAb2=listAb2.split(" ")
                    for (i=0, x=listAb2.length; i<x; i++) {
                        listAb2[i] = listAb2[i][0].toUpperCase() + listAb2[i].substr(1);
                    }
                    listAb2=listAb2.join(" ").slice(0,-2);

                    document.getElementById("ab2").innerHTML=" ";
                    document.getElementById("ab2").innerHTML=listAb2;
                    }
                }
            }
        }
    }
}

//Screenshot of autogen pokemon
function picError(imgsrc) {
    imgsrc=imgsrc.split("/")[imgsrc.split("/").length-1];
    var index=imgsrc.split(".")[0];
    imgsrc="http://51.254.32.10/B2/"+index+"/"+imgsrc
    return imgsrc;
}


//Ability fusion function
function fusAb(mon1,mon2) {
    var fabs = [];
    var H0 = mon1[0][0].name;
    if (mon1.length==3 && mon1[2][1]==true) {
        var H1 = mon1[1][0].name;
        var HH = mon1[2][0].name;
    }else if (mon1.length==2 && mon1[1][1]==true) {
        var HH = mon1[1][0].name;
    } else if (mon1.length==2 && mon1[1][1]==false){
        var H1 = mon1[1][0].name;
    }
    var B0 = mon2[0][0].name;
    if (mon2.length==3 && mon2[2][1]==true) {
        var B1 = mon2[1][0].name;
        var BH = mon2[2][0].name;  
    }else if (mon2.length==2 && mon2[1][1]==true) {
        var BH = mon2[1][0].name;
    } else if (mon1.length==2 && mon1[1][1]==false){
        var B1 = mon2[1][0].name;
    }
    //cas H0/null/null + B0/null/null [H0=B0] -> H0/null/null
    if (mon1.length==1 && mon2.length==1 && mon1[0][1]==false && mon2[0][1]==false) {
        if (H0==B0) {
            fabs.push(H0);
    //cas H0/null/null + B0/null/null [H0#B0] -> H0/B0/null
        } else if (H0!=B0) {
            fabs.push(H0);
            fabs.push(B0);
        }
    //cas H0/H1/null + B0/null/null [H0=B0] -> H0/H1/null
    } else if (mon1.length==2 && mon2.length==1 && mon1[0][1]==false && mon1[1][1]==false && mon2[0][1]==false) {
        if (H0==B0) {
            fabs.push(H0);
            fabs.push(H1);
    //cas H0/H1/null + B0/null/null [H0#B0] -> H0/B0/H1
        } else if (H0!=B0) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(H1);
        }
    //cas H0/null/HH + B0/null/null [H0=B0 | HH=B0] -> H0/null/HH
    } else if (mon1.length==2 && mon2.length==1 && mon1[0][1]==false && mon1[1][1]==true && mon2[0][1]==false) {
        if (H0==B0 || H1==B0) {
            fabs.push(H0);
            fabs.push(HH);
    //cas H0/null/HH + B0/null/null [H0#B0 & HH#B0] -> H0/B0/HH
        } else if (H0!=B0 && HH!=B0) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(HH);
        }
    //cas H0/H1/HH + B0/null/null [H0=B0 | B0=HH] -> H0/H1/HH
    } else if (mon1.length==3 && mon2.length==1 && mon1[0][1]==false && mon1[1][1]==false && mon1[2][1]==true && mon2[0][1]==false) {
        if (H0==B0 || B0==HH) {
            fabs.push(H0);
            fabs.push(H1);
            fabs.push(HH);
    //cas H0/H1/HH + B0/null/null [H0#B0 & HH#B0] -> H0/B0/HH
        } else if (H0!=B0 && HH!=B0) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(HH);
        }
    //cas H0/null/null + B0/B1/null [H0=B1] -> H0/B0/null
    } else if (mon1.length==1 && mon2.length==2 && mon1[0][1]==false && mon2[0][1]==false && mon2[1][1]==false) {
        if (H0==B1) {
            fabs.push(H0);
            fabs.push(B0);
    //cas H0/null/null + B0/B1/null [H0=B0] -> H0/B1/null
        } else if (H0==B0) {
            fabs.push(H0);
            fabs.punch(B1);
    //cas H0/null/null + B0/B1/null [H0#B0 & H0#B1] -> H0/B1/B0
        } else if (H0!=B0 && H0!=B1) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(B0);
        }
    //cas H0/H1/null + B0/B1/null [H0=B1] -> H0/B0/H1
    } else if (mon1.length==2 && mon2.length==2 && mon1[0][1]==false && mon1[1][1]==false && mon2[0][1]==false && mon2[1][1]==false) {
        if (H0==B1) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(H1);
    //cas H0/H1/null + B0/B1/null [H0=B0] -> H0/B1/H1
        } else if (H0==B0) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(H1);
    //cas H0/H1/null + B0/B1/null [H1#B0 & H1#B1] -> H0/B1/H1
        } else if (H1!=B0 && H1!=B1) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(H1);
        }
    //cas H0/null/HH + B0/B01/null [H0=B1 | HH=B1] -> H0/B0/HH
    } else if (mon1.length==2 && mon2.length==2 && mon1[0][1]==false && mon1[1][1]==true && mon2[0][1]==false && mon2[1][1]==false) {
        if (H0==B1 || HH==B1) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(HH);
    //cas H0/null/HH + B0/B1/null [H0#B1 & HH#B1] -> H0/B1/HH
        } else if (H0!=B1 && HH!=B1) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(H1);
        }
    //cas H0/H1/HH + B0/B1/null [H0=B1 | HH=B1] -> H0/B0/HH
    } else if (mon1.length==3 && mon2.length==2 && mon1[0][1]==false && mon1[1][1]==false && mon1[2][1]==true && mon2[0][1]==false && mon2[1][1]==false) {
        if (H0==B1 || HH==B1) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(HH);
    //cas H0/H1/HH + B0/B1/null [H0#B1 & HH#B1] -> H0/B1/HH
        } else if (H0!=B1 && HH!=B1) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(HH);
        }
    //cas H0/null/null + B0/null/BH [H0=BH] -> H0/null/B0
    } else if (mon1.length==1 && mon2.length==2 && mon1[0][1]==false && mon2[0][1]==false && mon2[1][1]==true) {
        if (H0==BH) {
            fabs.push(H0);
            fabs.push(B0);
    //cas H0/null/null + B0/null/BH [H0=B0] -> H0/null/BH
        } else if (H0==B0) {
            fabs.push(H0);
            fabs.push(BH);
    //cas H0/null/null + B0/null/BH [H0#B0 & H0#BH] -> H0/B0/BH
        } else if (H0!=B0 && H0!=BH) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(BH);
        }
    //cas H0/H1/null + B0/null/BH [H0=BH] -> H0/B0/H1
    } else if (mon1.length==2 && mon2.length==2 && mon1[0][1]==false && mon1[1][1]==false && mon2[0][1]==false && mon2[1][1]==true) {
        if (H0==BH) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(H1);
    //cas H0/H1/null + B0/null/BH [H0=B0] -> H0/BH/H1
        } else if (H0==B0) {
            fabs.push(H0);
            fabs.push(BH);
            fabs.push(H1);
    //cas H0/H1/null + B0/null/BH [H0#BH & H1#BH] -> H0/H1/BH
        } else if (H0!=BH && H1!=BH) {
            fabs.push(H0);
            fabs.push(H1);
            fabs.push(BH);
        }
    //cas H0/null/HH + B0/null/BH [H0=BH | HH=BH] -> H0/B0/HH
    } else if (mon1.length==2 && mon2.length==2 && mon1[0][1]==false && mon1[1][1]==true && mon2[0][1]==false && mon2[1][1]==true) {
        if (H0==BH || HH==BH) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(HH);
    //cas H0/null/HH + B0/null/BH [H0#BH & HH#BH] -> H0/BH/HH
        } else if (H0!=BH && HH!=BH) {
            fabs.push(H0);
            fabs.push(BH);
            fabs.push(HH);
        }
    //cas H0/H1/HH + B0/null/BH [H0=BH | HH=BH] -> H0/B0/HH
    } else if (mon1.length==3 && mon2.length==2 && mon1[0][1]==false && mon1[1][1]==false && mon1[2][1]==true && mon2[0][1]==false && mon2[1][1]==true) {
        if (H0==BH || HH==BH) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(HH);
    //cas H0/H1/HH + B0/null/BH [H0#BH & HH#BH] -> H0/BH/HH
        } else if (H0!=BH && HH!=BH) {
            fabs.push(H0);
            fabs.push(BH);
            fabs.push(HH);
        }
    //cas H0/null/null + B0/B1/BH [H0#B1 & H0#BH] -> H0/B1/BH
    } else if (mon1.length==1 && mon2.length==3 && mon1[0][1]==false  && mon2[0][1]==false && mon2[1][1]==false && mon2[2][1]==true) {
        if (H0!=B1 && H0!=BH) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(BH);
    //cas H0/null/null + B0/B1/BH [H0=B1] -> H0/B0/BH
        } else if (H0==B1) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(BH);
    //cas H0/null/null + B0/B1/BH [H0=BH] -> H0/B1/B0
        } else if (H0==BH) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(B0);
        }
    //cas H0/H1/null + B0/B1/BH [H0#B1 & H0#BH] -> H0/B1/BH
    } else if (mon1.length==2 && mon2.length==3 && mon1[0][1]==false && mon1[1][1]==false && mon2[0][1]==false && mon2[1][1]==false && mon2[2][1]==true) {
        if (H0==B1 || H0==BH) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(BH);
    //cas H0/H1/null + B0/B1/BH [H0=B1] -> H0/B0/BH
        } else if (H0==B1) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(BH);
    //cas H0/H1/null + B0/B1/BH [H0=BH] -> H0/B1/B0
        } else if (H0==BH) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(B0);
        }
    //cas H0/null/HH + B0/B1/BH [H0#B1 & HH#B1] -> H0/B1/HH
    } else if (mon1.length==2 && mon2.length==3 && mon1[0][1]==false && mon1[1][1]==true && mon2[0][1]==false && mon2[1][1]==false && mon2[2][1]==true) {
        if (H0!=B1 && HH!=B1) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(HH);
    //cas H0/null/HH + B0/B1/BH [H0=B1 | HH=B1] -> H0/B0/HH
        } else if (H0==B1 || HH==B1) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(HH);
    //cas H0/null/HH + B0/B1/BH [H0=B0 | HH=B0] -> H0/B1/HH
        } else if (H0==B0 || HH==B0) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(HH);
        }
    //cas H0/H1/HH + B0/B1/BH [H0#B1 & HH#B1] -> H0/B1/HH
    } else if (mon1.length==3 && mon2.length==3 && mon1[0][1]==false && mon1[1][1]==false && mon1[2][1]==true && mon2[0][1]==false && mon2[1][1]==false && mon2[2][1]==true) {
        if (H0!=B1 && HH!=B1) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(HH);
    //cas H0/H1/HH + B0/B1/BH [H0=B1 | HH=B1] -> H0/B0/HH
        } else if (H0==B1 || HH==B1) {
            fabs.push(H0);
            fabs.push(B0);
            fabs.push(HH);
    //cas H0/H1/HH + B0/B1/BH [H0=B0 | HH=B0] -> H0/B1/HH
        } else if (H0==B0 || HH==B0) {
            fabs.push(H0);
            fabs.push(B1);
            fabs.push(HH);
        }
    }
	return fabs
}


//Type fusion function
function fusType(mon1,mon2) {
    //cas H0/null + B0/null [H0#B0] -> H0/B0
    var fmon = []
    if (mon1.length==1 && mon2.length==1) {
        if (mon1[0]!=mon2[0]) {
            fmon.push(mon1[0]);
            fmon.push(mon2[0])
    //cas H0/null + B0/null [H0=B0] -> H0/null
        } else {
            fmon.push(mon1[0]);
        }
    } else if (mon1.length==2 && mon2.length==1) {
    //cas H0/H1 + B0/null [H0#B0] -> H0/B0
        if (mon1[0]!=mon2[0]) {
            fmon.push(mon1[0]);
            fmon.push(mon2[0]);
    //cas H0/H1 + B0/null [H0=B0] -> H0/H1
        } else {
            fmon.push(mon1[0]);
            fmon.push(mon1[1]);
        }
    } else if (mon1.length==1 && mon2.length==2) {
    //cas H0/null + B0/B1 [H0#B1] -> H0/B1
            fmon.push(mon1[0]);
            fmon.push(mon2[1]);

    //cas H0/H1 + B0/B1 [H0=B1] -> H0/B0
    } else if (mon1.length==2 && mon2.length==2) {
        if (mon1[0]==mon2[1]) {
            fmon.push(mon1[0]);
            fmon.push(mon2[0]);
    //cas H0/H1 + B0/B1 [H0#B1] -> H0/B1
        } else {
            fmon.push(mon1[0]);
            fmon.push(mon2[1]);
        }
    }
    return fmon
}